# Author : Jigesh Sheoran / sheoraninfosec / bug0x
# Last Updated : 11 September, 2025

HOMOGLYPH_MAP = {
    # Mathematical Bold Capital Letters
    "ð€": "A", "ð": "B", "ð‚": "C", "ðƒ": "D", "ð„": "E", "ð…": "F", "ð†": "G",
    "ð‡": "H", "ðˆ": "I", "ð‰": "J", "ðŠ": "K", "ð‹": "L", "ðŒ": "M", "ð": "N",
    "ðŽ": "O", "ð": "P", "ð": "Q", "ð‘": "R", "ð’": "S", "ð“": "T", "ð”": "U",
    "ð•": "V", "ð–": "W", "ð—": "X", "ð˜": "Y", "ð™": "Z",
    "ðš": "a", "ð›": "b", "ðœ": "c", "ð": "d", "ðž": "e", "ðŸ": "f", "ð ": "g",
    "ð¡": "h", "ð¢": "i", "ð£": "j", "ð¤": "k", "ð¥": "l", "ð¦": "m", "ð§": "n",
    "ð¨": "o", "ð©": "p", "ðª": "q", "ð«": "r", "ð¬": "s", "ð­": "t", "ð®": "u",
    "ð¯": "v", "ð°": "w", "ð±": "x", "ð²": "y", "ð³": "z",

    # Mathematical Italic Capital Letters
    "ð´": "A", "ðµ": "B", "ð¶": "C", "ð·": "D", "ð¸": "E", "ð¹": "F", "ðº": "G",
    "ð»": "H", "ð¼": "I", "ð½": "J", "ð¾": "K", "ð¿": "L", "ð‘€": "M", "ð‘": "N",
    "ð‘‚": "O", "ð‘ƒ": "P", "ð‘„": "Q", "ð‘…": "R", "ð‘†": "S", "ð‘‡": "T", "ð‘ˆ": "U",
    "ð‘‰": "V", "ð‘Š": "W", "ð‘‹": "X", "ð‘Œ": "Y", "ð‘": "Z",
    "ð‘Ž": "a", "ð‘": "b", "ð‘": "c", "ð‘‘": "d", "ð‘’": "e", "ð‘“": "f", "ð‘”": "g",
    "â„Ž": "h", "ð‘–": "i", "ð‘—": "j", "ð‘˜": "k", "ð‘™": "l", "ð‘š": "m", "ð‘›": "n",
    "ð‘œ": "o", "ð‘": "p", "ð‘ž": "q", "ð‘Ÿ": "r", "ð‘ ": "s", "ð‘¡": "t", "ð‘¢": "u",
    "ð‘£": "v", "ð‘¤": "w", "ð‘¥": "x", "ð‘¦": "y", "ð‘§": "z",

    # Mathematical Bold Italic
    "ð‘¨": "A", "ð‘©": "B", "ð‘ª": "C", "ð‘«": "D", "ð‘¬": "E", "ð‘­": "F", "ð‘®": "G",
    "ð‘¯": "H", "ð‘°": "I", "ð‘±": "J", "ð‘²": "K", "ð‘³": "L", "ð‘´": "M", "ð‘µ": "N",
    "ð‘¶": "O", "ð‘·": "P", "ð‘¸": "Q", "ð‘¹": "R", "ð‘º": "S", "ð‘»": "T", "ð‘¼": "U",
    "ð‘½": "V", "ð‘¾": "W", "ð‘¿": "X", "ð’€": "Y", "ð’": "Z",
    "ð’‚": "a", "ð’ƒ": "b", "ð’„": "c", "ð’…": "d", "ð’†": "e", "ð’‡": "f", "ð’ˆ": "g",
    "ð’‰": "h", "ð’Š": "i", "ð’‹": "j", "ð’Œ": "k", "ð’": "l", "ð’Ž": "m", "ð’": "n",
    "ð’": "o", "ð’‘": "p", "ð’’": "q", "ð’“": "r", "ð’”": "s", "ð’•": "t", "ð’–": "u",
    "ð’—": "v", "ð’˜": "w", "ð’™": "x", "ð’š": "y", "ð’›": "z",

    # Mathematical Script Letters (Fraktur, Double-Struck, Sans-serif, etc.)
    "ð’œ": "A", "ð’ž": "C", "ð’Ÿ": "D", "ð’¢": "G", "â„‹": "H", "ð’¥": "J", "ð’¦": "K",
    "ð’©": "N", "ð’ª": "O", "ð’«": "P", "ð’¬": "Q", "ð’®": "S", "ð’¯": "T", "ð’°": "U",
    "ð’±": "V", "ð’²": "W", "ð’³": "X", "ð’´": "Y", "ð’µ": "Z",
    "ð’¶": "a", "ð’·": "b", "ð’¸": "c", "ð’¹": "d", "â„¯": "e", "ð’»": "f", "â„Š": "g",
    "ð’½": "h", "ð’¾": "i", "ð’¿": "j", "ð“€": "k", "ð“": "l", "ð“‚": "m", "ð“ƒ": "n",
    "â„´": "o", "ð“…": "p", "ð“†": "q", "ð“‡": "r", "ð“ˆ": "s", "ð“‰": "t", "ð“Š": "u",
    "ð“‹": "v", "ð“Œ": "w", "ð“": "x", "ð“Ž": "y", "ð“": "z",

    # Add other ranges (Fraktur, Double-struck, Sans-serif bold/italic, etc.)
    # from your table here...
}

def contains_homoglyph(text: str) -> bool:
    return any(ch in HOMOGLYPH_MAP for ch in text)

def normalize_homoglyphs(text: str) -> str:
    """Replace homoglyphs with their ASCII equivalent"""
    return "".join(HOMOGLYPH_MAP.get(ch, ch) for ch in text)
